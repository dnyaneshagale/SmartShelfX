<div class="analytics-container">
  <mat-card class="header-card">
    <mat-card-header>
      <mat-card-title>Analytics & Reports</mat-card-title>
      <mat-card-subtitle>View inventory statistics and export reports</mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <div class="export-actions">
        <button mat-raised-button color="primary" (click)="exportPdf()">
          <mat-icon>picture_as_pdf</mat-icon> Export PDF
        </button>
        <button mat-raised-button color="accent" (click)="exportExcel()">
          <mat-icon>table_chart</mat-icon> Export Excel
        </button>
      </div>
    </mat-card-content>
  </mat-card>

  <div class="stats-grid" *ngIf="stats && !isLoading">
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-icon total"><mat-icon>inventory_2</mat-icon></div>
        <div class="stat-details">
          <span class="stat-value">{{stats.totalProducts}}</span>
          <span class="stat-label">Total Products</span>
        </div>
      </mat-card-content>
    </mat-card>
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-icon instock"><mat-icon>check_circle</mat-icon></div>
        <div class="stat-details">
          <span class="stat-value">{{stats.inStockCount}}</span>
          <span class="stat-label">In Stock</span>
        </div>
      </mat-card-content>
    </mat-card>
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-icon lowstock"><mat-icon>warning</mat-icon></div>
        <div class="stat-details">
          <span class="stat-value">{{stats.lowStockCount}}</span>
          <span class="stat-label">Low Stock</span>
        </div>
      </mat-card-content>
    </mat-card>
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-icon value"><mat-icon>attach_money</mat-icon></div>
        <div class="stat-details">
          <span class="stat-value">{{stats.totalValue | currency}}</span>
          <span class="stat-label">Total Value</span>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <mat-card class="chart-card" *ngIf="!isLoading">
    <mat-card-header><mat-card-title>Stock Distribution</mat-card-title></mat-card-header>
    <mat-card-content class="chart-content">
      <div *ngIf="chartData && chartData.length > 0" class="chart-wrapper">
        <ngx-charts-pie-chart [results]="chartData" [scheme]="colorScheme" [legend]="true"
          [doughnut]="true"></ngx-charts-pie-chart>
      </div>
      <div *ngIf="!chartData || chartData.length === 0" class="no-data">
        <p>No inventory data available</p>
      </div>
    </mat-card-content>
  </mat-card>

  <div class="loading-container" *ngIf="isLoading"><mat-spinner></mat-spinner></div>
</div>